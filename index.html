<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì‚¬íšŒ ë´‰ì‚¬ ê²Œì„</title>
<style>
body { font-family: Arial; text-align:center; background:#f0f8ff; margin:0; padding:0;}
h1 {margin:20px 0;}
#score,#timer,#message {font-size:20px; margin:10px;}
#message {height:26px; font-weight:bold;}
#gameArea {margin:20px auto; max-width:90%; min-height:360px; display:flex; justify-content:center; align-items:center; border:2px solid #333; border-radius:10px; background:#fff; padding:10px; overflow:hidden;}
.person {width:100%; max-width:240px; padding:10px;}
.person img {width:100%; max-width:140px; object-fit:contain;}
.dropZone {margin-top:10px; border:2px dashed #888; border-radius:10px; height:100px; line-height:100px; font-size:16px; color:#666; background:#f9f9f9; touch-action:none;}
#resources {margin-top:30px; display:flex; justify-content:center; gap:15px; flex-wrap:wrap;}
.resource {width:80px; height:80px; border:2px solid #333; border-radius:15px; background:#fafafa; font-size:40px; line-height:80px; cursor:grab; user-select:none; touch-action:none; position:relative;}
</style>
</head>
<body>
<h1>ì‚¬íšŒ ë´‰ì‚¬ ê²Œì„</h1>
<div id="score">ì ìˆ˜: 0</div>
<div id="timer">ë‚¨ì€ ì‹œê°„: 30ì´ˆ</div>
<div id="message"></div>
<div id="gameArea"></div>
<div id="resources">
  <div class="resource" data-value="ğŸ">ğŸ</div>
  <div class="resource" data-value="ğŸ“–">ğŸ“–</div>
  <div class="resource" data-value="â™¿">â™¿</div>
  <div class="resource" data-value="ğŸ¼">ğŸ¼</div>
  <div class="resource" data-value="ğŸ’Š">ğŸ’Š</div>
</div>

<script>
let score=0, timeLeft=30, currentNeed="";
const scoreDisplay=document.getElementById("score");
const timerDisplay=document.getElementById("timer");
const messageDisplay=document.getElementById("message");
const gameArea=document.getElementById("gameArea");

const people=[
  {name:"ë…¸ì¸", need:"ğŸ", desc:"ë°°ê³ í”” í•´ê²°ì´ í•„ìš”í•´ìš”", img:"https://cdn-icons-png.flaticon.com/512/7703/7703936.png"},
  {name:"ì•„ì´", need:"ğŸ“–", desc:"ê³µë¶€í•  ì±…ì´ í•„ìš”í•´ìš”", img:"https://cdn-icons-png.flaticon.com/512/201/201818.png"},
  {name:"ì¥ì• ì¸", need:"â™¿", desc:"ì´ë™ ë³´ì¡°ê°€ í•„ìš”í•´ìš”", img:"https://cdn-icons-png.flaticon.com/512/1806/1806208.png"},
  {name:"ì„ì‚°ë¶€", need:"ğŸ¼", desc:"ê±´ê°•í•œ ìŒì‹ì´ í•„ìš”í•´ìš”", img:"https://cdn-icons-png.flaticon.com/512/8229/8229514.png"},
  {name:"í™˜ì", need:"ğŸ’Š", desc:"ì•½ì´ í•„ìš”í•´ìš”", img:"https://cdn-icons-png.flaticon.com/512/892/892781.png"}
];
let recentPeople=[];

// ëœë¤ ì‚¬ëŒ ë³´ì—¬ì£¼ê¸°
function showRandomPerson(){
  let p;
  do{ p=people[Math.floor(Math.random()*people.length)]; } while(recentPeople.includes(p));
  recentPeople.push(p); if(recentPeople.length>3) recentPeople.shift();
  currentNeed=p.need;

  gameArea.innerHTML=`<div class="person" data-need="${p.need}">
    <img src="${p.img}" alt="${p.name}">
    <h3>${p.name}</h3>
    <p>${p.desc}</p>
    <div class="dropZone">ì—¬ê¸°ì— ìì›ì„ ë‘ì„¸ìš”</div>
  </div>`;

  const dropZone=document.querySelector(".dropZone");
  dropZone.addEventListener("dragover",e=>e.preventDefault());
  dropZone.addEventListener("drop", handleDrop);
  dropZone.addEventListener("touchend", handleDropTouch);
}

// ì ìˆ˜ ë©”ì‹œì§€
function showMessage(text,color){
  messageDisplay.textContent=text;
  messageDisplay.style.color=color;
  setTimeout(()=>messageDisplay.textContent="",700);
}

// ë“œë¡­ ì²˜ë¦¬ (ë°ìŠ¤í¬íƒ‘)
function handleDrop(e){
  e.preventDefault();
  const value=e.dataTransfer.getData("text");
  updateScore(value);
}

// ë“œë¡­ ì²˜ë¦¬ (ëª¨ë°”ì¼)
function handleDropTouch(e){
  e.preventDefault();
  if(draggedItem) updateScore(draggedItem.dataset.value, true);
}

function updateScore(value, isTouch=false){
  if(value===currentNeed){ score+=10; showMessage("ì˜¬ë°”ë¥´ê²Œ ë„ì™€ì¤¬ì–´ìš”! ğŸ˜Š","green"); }
  else{ score-=5; showMessage("ì˜ëª»ëœ ìì›ì´ì˜ˆìš” ğŸ˜¢","red"); }
  scoreDisplay.textContent="ì ìˆ˜: "+score;
  if(isTouch){
    draggedItem.style.position=""; draggedItem.style.left=""; draggedItem.style.top=""; draggedItem.style.zIndex="";
  }
  draggedItem=null;
  setTimeout(showRandomPerson,500);
}

// ë°ìŠ¤í¬íƒ‘ ë“œë˜ê·¸
const resources=document.querySelectorAll(".resource");
resources.forEach(r=>{
  r.addEventListener("dragstart",e=>e.dataTransfer.setData("text", r.dataset.value));
  r.addEventListener("touchstart", touchStart);
  r.addEventListener("touchmove", touchMove);
});

let draggedItem=null, offsetX=0, offsetY=0;
function touchStart(e){
  draggedItem=e.target;
  const touch=e.touches[0];
  const rect=draggedItem.getBoundingClientRect();
  offsetX=touch.clientX-rect.left; offsetY=touch.clientY-rect.top;
  draggedItem.style.position="absolute";
  draggedItem.style.zIndex=1000;
}
function touchMove(e){
  if(!draggedItem) return;
  const touch=e.touches[0];
  draggedItem.style.left=touch.clientX-offsetX+"px";
  draggedItem.style.top=touch.clientY-offsetY+"px";
}

// íƒ€ì´ë¨¸
const timer=setInterval(()=>{
  timeLeft--; timerDisplay.textContent="ë‚¨ì€ ì‹œê°„: "+timeLeft+"ì´ˆ";
  if(timeLeft<=0){ clearInterval(timer); endGame(); }
},1000);

function endGame(){
  gameArea.innerHTML=`<div style="padding:20px;"><h2>ğŸ‰ ê²Œì„ ì¢…ë£Œ! ğŸ‰</h2><p>ë‹¹ì‹ ì˜ ì ìˆ˜ëŠ” <strong>${score}ì </strong> ì…ë‹ˆë‹¤.</p></div>`;
  messageDisplay.textContent="";
}

showRandomPerson();
</script>
</body>
</html>
